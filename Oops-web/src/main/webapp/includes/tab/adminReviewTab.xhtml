<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    
    <div>
        <h:outputText value="Avis en attente de traitement :"/>
        <p:panelGrid>
            <c:forEach items="#{manageReviewBean.reviewList}" var="review" >
                <p:panel>
                    <!-- Review informations -->
                    <p:panelGrid styleClass="leftPanelAdmin" columns="2">
                        <p:panel style="width: 50px; text-align: center;">
                            <h:graphicImage value="#{review.contractor.logo}" width="30px"/>
                        </p:panel>
                        <p:panel>
                            <h:outputLabel value="#{review.appreciation}" style="width:100%;" />
                            <h:outputLabel value="#{review.content}" style="width:100%;" />
                            <p:panelGrid columns="2">
                                <h:outputLabel value="Le #{review.date}" />
                                <p:rating id="stars2" value="#{review.rating}" stars="5" readonly="true"/>
                            </p:panelGrid>
                        </p:panel>
                    </p:panelGrid>
                    <!-- Moderator actions -->
                    <p:panelGrid styleClass="rightPanelAdmin" columns="3">
                        <h:form id="formDecision">
                            <p:panel>
                                <p:panel style="width: 100%;">
                                    <h:outputLabel value="DÃ©cision" />
                                </p:panel>
                                <p:panel>
                                    <h:commandButton value="Valider" action="#{manageReviewBean.validateReview(review.id)}" >
                                        <f:ajax execute="formDecision" render="@none" />
                                    </h:commandButton>
                                    <h:commandButton value="Modifier" action="#{manageReviewBean.modifyReview(review.id)}" >
                                        <f:ajax execute="formDecision" render="@none" />
                                    </h:commandButton>
                                    <h:commandButton value="Rejeter" action="#{manageReviewBean.rejectReview(review.id)}" >
                                        <f:ajax execute="formDecision" render="@none" />
                                    </h:commandButton>
                                </p:panel>
                            </p:panel>
                        </h:form>
                        <h:form>
                            <p:panel>
                                <h:outputLabel value="Description" />
                                <p:inputTextarea id="reviewContent" rows="6" cols="20" value="#{manageReviewBean.contentReview[review.id]}" required="false" label="Facultatif" />
                            </p:panel>
                            <h:commandButton value="Envoyer" action="#{manageReviewBean.manageReview(review.id)}" />
                        </h:form>
                    </p:panelGrid>
                </p:panel>
            </c:forEach>
        </p:panelGrid>
    </div>
    
</ui:composition>