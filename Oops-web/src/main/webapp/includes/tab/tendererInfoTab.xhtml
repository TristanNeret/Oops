<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
    xmlns:p="http://primefaces.org/ui"
    xmlns:o="http://omnifaces.org/ui"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <script type="text/javascript">
        function handleUpdateRequest(xhr, status, args) {
            if (args.validationFailed) {
                //PF('infoDialog').jq.effect("shake", {times: 5}, 100);
                PF('infoDialog').show();
            }
            else {
                PF('infoDialog').hide();
                PF('updateGrowl').renderMessage({summary: 'Modifications enregistrées !', severity: 'info'});
            }
        }

    </script>

    <div class="container">

        <o:form id="infoForm" includeViewParams="true">

            <div class="divTendererAvatar">
                <h:graphicImage value="#{tendererInfoMngBean.tenderer.avatar}" height="150px" rendered="#{tendererInfoMngBean.isAvatar()}" />
                <h:outputLabel value="Aucune image" rendered="#{!tendererInfoMngBean.isAvatar()}" />
            </div>

            <p:panel id="content" class="panelTendererInformation">
                <table id="table">
                    <tr>
                        <td class="labelTitleTendererInformation">Login : </td>
                        <td><h:outputText value="#{tendererInfoMngBean.tenderer.login}"/></td>
                    </tr>
                    <tr>
                        <td class="labelTitleTendererInformation">Prénom : </td>
                        <td><h:outputText value="#{tendererInfoMngBean.tenderer.firstname}"/></td>
                    </tr>
                    <tr>
                        <td class="labelTitleTendererInformation">Nom : </td>
                        <td><h:outputText value="#{tendererInfoMngBean.tenderer.lastname}"/></td>
                    </tr>
                    <tr>
                        <td class="labelTitleTendererInformation">E-mail : </td>
                        <td><h:outputText value="#{tendererInfoMngBean.tenderer.email}"/></td>
                    </tr>
                    <tr>
                        <td class="labelTitleTendererInformation">Téléphone : </td>
                        <td><h:outputText value="#{tendererInfoMngBean.tenderer.phone}"/></td>
                    </tr>
                    <tr>
                        <td class="labelTitleTendererInformation">Inscrit depuis le : </td>
                        <td><h:outputText value="#{tendererInfoMngBean.tenderer.registrationDate}"/></td>

                    </tr>
                </table>

                <p:commandButton id="modifier" value="Modifier" styleClass="commandButtonEditTenderer" update="dialogEditInfo" oncomplete="PF('infoDialog').show();" />
            </p:panel>

            <!-- Dialog view to edit a Tenderer -->
            <p:growl id="updateGrowl" widgetVar="updateGrowl" sticky="false" showDetail="false" life="3000" />
            <p:dialog id="dialogEditInfo" header="Modifier mes informations :" modal="true" widgetVar="infoDialog" dynamic="true" resizable="false">

                <h:panelGrid columns="3" cellpadding="6">

                    <h:outputLabel value="Avatar :" />
                    <p:inputText id="avatar" value="#{tendererInfoMngBean.tenderer.avatar}">
                           <f:validator validatorId="com.gdf.urlLogoValidator"/>
                    </p:inputText>       
                    <p:message id="avatarMessage" for="avatar"/>

                    
                    <h:outputLabel value="Login :" />
                    <p:inputText id="login" value="#{tendererInfoMngBean.tenderer.login}">
                        <f:validator validatorId="com.gdf.loginAlreadyExistForModificationValidator"/>
                    </p:inputText>
                    <p:message id="loginMessage" for="login"/>

                    <h:outputLabel value="Prénom :" />
                    <p:inputText id="firstname" value="#{tendererInfoMngBean.tenderer.firstname}" required="true" label="Prénom">
                        <f:validator validatorId="com.gdf.noBlankSpaceValidator" binding="#{noBlankSpaceValidator}" />
                    </p:inputText>
                    <p:message id="firstnameMessage" for="firstname"/>

                    <h:outputLabel value="Nom :" />
                    <p:inputText id="lastname" value="#{tendererInfoMngBean.tenderer.lastname}" required="true" label="Nom">
                        <f:validator validatorId="com.gdf.noBlankSpaceValidator" binding="#{noBlankSpaceValidator}" />
                    </p:inputText>
                    <p:message id="lastnameMessage" for="lastname"/>

                    <h:outputLabel value="E-mail :" />
                    <p:inputText id="email" value="#{tendererInfoMngBean.tenderer.email}" required="true" label="E-mail">
                        <f:validator validatorId="com.gdf.mailFormatValidator" binding="#{mailFormatValidator}" />
                        <f:validator validatorId="com.gdf.emailAlreadyExistForModificationValidator"/>                 
                    </p:inputText>
                    <p:message id="emailMessage" for="email"/>

                    <h:outputLabel value="Téléphone :" />
                    <p:inputText id="phone" value="#{tendererInfoMngBean.tenderer.phone}" required="true">
                        <f:validator validatorId="com.gdf.phoneFormatValidator"/>
                    </p:inputText>
                    <p:message id="phoneMessage" for="phone"/>


                    <h:outputLabel value="Mot de passe :" />
                    <p:password id="password" value="#{tendererInfoMngBean.password}" match="passconfirm" feedback="true" placeholder="Laissez vide pour ne pas modifier" validatorMessage="Problème de mot de passe." />
                    <p:message id="passwordMessage" for="password"/>
                    
                    <h:outputLabel value="Confirmez le mot de passe :" />
                    <p:password id="passconfirm" value="#{tendererInfoMngBean.passConfirm}" feedback="true" placeholder="Laissez vide pour ne pas modifier" />
                    <p:message id="passconfirmMessage" for="passconfirm"/>
                    
                    <f:facet name="footer">
                        <p:commandButton id="enregistrer" value="Enregistrer" action="#{tendererInfoMngBean.update()}" 
                                         oncomplete="handleUpdateRequest(xhr, status, args)" update="updateGrowl :tabViewTenderer:infoForm" />
                        <p:commandButton value="Annuler" oncomplete="PF('infoDialog').hide();" />
                    </f:facet>  

                </h:panelGrid>

            </p:dialog>
        </o:form>
    </div>

</ui:composition>